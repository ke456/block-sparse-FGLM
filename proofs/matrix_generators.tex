%%%preamble.
\documentclass[12pt]{article}

\usepackage[english]{babel}
\usepackage{enumerate}
\usepackage{fullpage}
\usepackage[colorlinks=true,linkcolor=cyan]{hyperref}

% for enumerate / itemize: define reasonable margins
\usepackage[shortlabels]{enumitem}
\setlist{topsep=0.25\baselineskip,partopsep=0pt,itemsep=1pt,parsep=0pt}

% math and theorem names
\usepackage{amsmath,amsfonts,amssymb,amsthm,thmtools}
\declaretheorem[style=plain,parent=section]{definition}
\declaretheorem[sibling=definition]{theorem}
\declaretheorem[sibling=definition]{corollary}
\declaretheorem[sibling=definition]{proposition}
\declaretheorem[sibling=definition]{lemma}
\declaretheorem[style=remark,sibling=definition,qed={\qedsymbol}]{remark}
\declaretheorem[style=remark,sibling=definition,qed={\qedsymbol}]{example}
\declaretheoremstyle[headpunct={},notebraces={\textbf{--}~}{}]{algorithm}
\declaretheorem[style=algorithm]{problem}
\declaretheorem[style=algorithm]{algorithm}

% for our algorithms & problems
\usepackage{mdframed}

\usepackage[capitalize]{cleveref}

\title{Matrix Berlekamp-Massey}

\author{}
\date{\today}

%%%notation
%misc
\newcommand{\storeArg}{} % aux, not to be used in document!!
\newcounter{notationCounter}
%integers
\renewcommand{\ge}{\geqslant} % greater or equal
\renewcommand{\le}{\leqslant} % lesser or equal
%spaces
\newcommand{\NN}{\mathbb{Z}_{\ge 0}} % nonnegative integers
\newcommand{\var}{X} % variable for univariate polynomials
\newcommand{\field}{\mathbb{K}} % base field
\newcommand{\polRing}{\field[\var]} % polynomial ring
\newcommand{\Pox}{[\mkern-3mu[ \var ]\mkern-3.2mu]}
\newcommand{\psRing}{\field\Pox}
\newcommand{\matSpace}[1][\rdim]{\renewcommand\storeArg{#1}\matSpaceAux} % polynomial matrix space, 2 opt args
\newcommand{\matSpaceAux}[1][\storeArg]{\field^{\storeArg \times #1}} % not to be used in document
\newcommand{\polMatSpace}[1][\rdim]{\renewcommand\storeArg{#1}\polMatSpaceAux} % polynomial matrix space, 2 opt args
\newcommand{\polMatSpaceAux}[1][\storeArg]{\polRing^{\storeArg \times #1}} % not to be used in document
\newcommand{\psMatSpace}[1][\rdim]{\renewcommand\storeArg{#1}\psMatSpaceAux} % polynomial matrix space, 2 opt args
\newcommand{\psMatSpaceAux}[1][\storeArg]{\psRing^{\storeArg \times #1}} % not to be used in document
\newcommand{\mat}[1]{\mathbf{\MakeUppercase{#1}}} % for a matrix
\newcommand{\row}[1]{\mathbf{\MakeLowercase{#1}}} % for a matrix
\newcommand{\col}[1]{\mathbf{\MakeLowercase{#1}}} % for a matrix
\newcommand{\matCoeff}[1]{\MakeLowercase{#1}} % for a coefficient in a matrix
\newcommand{\rdim}{m} % row dimension
\newcommand{\cdim}{n} % column dimension
\newcommand{\diag}[1]{\mathrm{Diag}(#1)}  % diagonal matrix with diagonal entries #1
\newcommand{\seqelt}[1]{S_{#1}} % element of sequence of matrices
\newcommand{\seqeltSpace}{\matSpace[\rdim][\cdim]} % element of sequence of matrices
\newcommand{\seq}{\mathcal{S}} % sequence of matrices
\newcommand{\seqpm}{\mat{S}} % power series matrix from a sequence
\newcommand{\rel}{\col{p}} % linear relation
\newcommand{\relbas}{\mat{p}} % linear relation
\newcommand{\relSpace}{\polMatSpace[1][\rdim]} % space for linear relations
\newcommand{\relbasSpace}{\polMatSpace[\rdim][\rdim]} % space for linear relations
\newcommand{\degBd}{\delta} % bound on degree of minimal generator

%% ------------------------------------------------
%% --------- For problems and algorithms ----------
%% ------------------------------------------------
\newcommand{\argfig}[1]{\begin{figure}[#1]} % to be able to feed an optional argument to the inside figure

\newenvironment{algobox}[1][htbp]{
  \newcommand{\algoInfo}[3]{
    \begin{algorithm}[{name=[\algoname{##2}:~##1]\algoname{##2}}]
    \label{##3}
    ~ \hfill
    {\small\emph{(##1)}}
    \smallskip

  }
  \newcommand{\dataInfos}[2]{
    \algoword{##1:}
      \begin{itemize}[topsep=0pt]
          ##2
      \end{itemize}
    \smallskip
  }
  \newcommand{\dataInfo}[2]{
    \algoword{##1:} ##2 
    %\smallskip
  }
  \newcommand{\algoSteps}[1]{
    %\smallskip
    \addtolength{\leftmargini}{-0.35cm}
    \begin{enumerate}[{\bf 1.}]
        ##1
    \end{enumerate}
    \smallskip
  }

  \expandafter\argfig\expandafter{#1}
    \centering
    \begin{minipage}{0.99\textwidth}
    \begin{mdframed}
      \smallskip
    }
    {
    \end{algorithm}
    \end{mdframed}
    \end{minipage}
  \end{figure}
}

\newenvironment{problembox}[1][htbp]{
  \newcommand{\problemInfo}[3]{
    \begin{problem}[{name=[\emph{##2}\ifx&##1&\else##1\fi]\emph{##2}}]
    \label{##3}
    ~\smallskip

  }
  \newcommand{\dataInfos}[2]{
    \emph{##1:}
    \begin{itemize}[topsep=0pt]
      ##2
    \end{itemize}
    \smallskip
  }
  \newcommand{\dataInfo}[2]{
    \emph{##1:}  ##2
  }

  \expandafter\argfig\expandafter{#1}
    \centering
    \begin{minipage}{0.75\textwidth}
    \begin{mdframed}
    }
    {
    \end{problem}
    \end{mdframed}
    \end{minipage}
  \end{figure}
}


\begin{document}
  \maketitle


\section{Definitions}
\label{sec:relations}

First thing: what are linearly recurrent sequences and minimal generators, when
talking about matrix sequences? The definition is essentially the same as in
the scalar case. There is a similar notion of generator of a sequence (which is
a matrix): it is related to the denominator in some minimal fraction
description of the generating series of the sequence.

We consider the following definition which extends the scalar case. It can be
found in \cite[Sec.\,3]{KalVil01}, and in \cite[Def.\,4.2]{Turner02}.

\begin{definition}
  \label{dfn:recurrence_relation}
  Let $\seq = (\seqelt{k})_{k\in\NN} \subset \matSpace[\rdim][\cdim]$. A vector
  $\rel = \sum_{0\le k\le d} p_k \var^k \in \relSpace$ of degree at most $d$ is
  said to be a \emph{(linear recurrence) relation for $\seq$} if
  $\sum_{k=0}^{d} p_{k} \seqelt{\delta + k} = 0$ for all $\delta \ge 0$.  Then,
  $\seq$ is said to be linearly recurrent if there exists a nontrivial relation
  for $\seq$.
\end{definition}

The set of relations for $\seq$ is a $\polRing$-submodule of $\relSpace$, which
has rank $\rdim$ if $\seq$ is linearly recurrent. This is showed in
\cite[Fact\,1]{KalYuh13} for sequences having a \emph{scalar} recurrence
relation. Let us now link this with the property of being linearly recurrent
as in the above definition.

\begin{lemma}
  The sequence $\seq$ is linearly recurrent if and only if there exists a
  polynomial $P(\var) = \sum_{0\le k\le d} p_k \var^k \in \polRing$ such that
  $\sum_{k=0}^{d} p_{k} \seqelt{\delta + k} = 0$ for all $\delta \ge 0$.
\end{lemma}
\begin{proof}
  ?
\end{proof}

Then, the fact that the relation module has rank $\rdim$ is straightforward: since
the sequence is linearly recurrent, it has a scalar recurrence polynomial
$P(\var)$, hence for each $i$ the vector $[0 \; \cdots \; 0 \; P(\var) \; 0 \;
\cdots \; 0]$ with $P(\var)$ at position $i$ is a relation for $\seq$.

A generating matrix for the sequence is a matrix whose rows form
a generating set for the module of relations; it is said to be
\begin{itemize}
  \item \emph{minimal} if the matrix is reduced \cite{Wolovich74,Kailath80};
  \item \emph{ordered weak Popov} if the matrix is in weak Popov form
    \cite{MulSto03} with pivots on the diagonal;
  \item \emph{canonical} if the matrix is in Popov form \cite{Popov72,Kailath80}.
\end{itemize}

%alternative definition from \cite{Thome02}.
%
%\begin{definition}[\cite{Thome02}]
%  \label{dfn:relation_thome}
%  Let $\seq = (\seqelt{k})_{k\in\NN} \subset \matSpace[\rdim][\cdim]$ be a
%  sequence of $\rdim\times\cdim$ matrices over $\field$. We define the
%  generating series $\seqpm = \sum_{k\ge 0} \seqelt{k} \var^k \in
%  \psMatSpace[\rdim][\cdim]$. Then, a vector $\rel \in \relSpace$ is said to be
%  a \emph{(linear recurrence) relation for $\seq$} if the product $\rel\seqpm$
%  has polynomial entries, that is, $\rel \seqpm \in \relSpace$.
%\end{definition}
%
%Assume there is a nontrivial relation $\rel = \sum_k p_k \var^k$ for $\seq$, we
%have
%\begin{equation}
%  \label{eqn:relation_thome}
%  \sum_{k=0}^{d} p_{k} \seqelt{\delta - k} = 0 \quad \text{ for all } d \ge
%  \deg(\rel) \text{ and } \delta \ge \max(d,\deg(\seqpm \rel)+1).
%\end{equation}
%The alternative definition focuses on this type of relation.
%\begin{lemma}
%  \label{lem:link_defs}
%  For a given sequence $\seq \subset \matSpace[\rdim][\cdim]$, a nonzero vector
%  $\rel \in \relSpace$ is a relation for \cref{dfn:relation_thome} if and only
%  if there exists $d \ge \deg(\rel)$ such that the reverse $\var^{d}
%  \rel(\var^{-1})$ is a relation for \cref{dfn:relation_ky}.
%\end{lemma}
%\begin{proof}
%  First, we assume that $\var^{d} \rel(\var^{-1}) = \sum_{k=0}^{d} p_{d-k}
%  \var^k$ is a relation for \cref{dfn:relation_ky}, for some integer $d \ge
%  \deg(\rel)$. This means that, for all $\delta \ge 0$, we have $0 =
%  \sum_{k=0}^{d} \seqelt{\delta + k} p_{d-k} = \sum_{k=0}^{d} \seqelt{\delta+d
%  - k} p_{k}$. This implies that $\seqpm\rel$ has polynomial entries (and
%  $\deg(\seqpm\rel) \le d$).
%
%  Now, we assume that $\rel$ is a relation for \cref{dfn:relation_thome}.
%  Taking $d = \max(\deg(\rel),\deg(\seqpm \rel)+1)$ in
%  \cref{eqn:relation_thome}, we obtain $\sum_{k=0}^{d} \seqelt{\delta - k}
%  p_{k} = 0$ for all $\delta \ge d$. This implies $\sum_{k=0}^{d}
%  \seqelt{\delta-d + k} p_{d-k} = 0$ for all $\delta\ge d$, or equivalently,
%  $\sum_{k=0}^{d} \seqelt{\delta+k} p_{d-k} = 0$ for all $\delta\ge 0$.
%  Therefore the reverse $\var^{d} \rel(\var^{-1})$ is a relation for
%  \cref{dfn:relation_ky}.
%\end{proof}

\section{Computing a minimal matrix generators}
\label{sec:computing_matrix_generators}

We consider the following problem.

\begin{problembox}[htbp]
  \problemInfo
  {}
  {Minimal generator}
  {pbm:mingen}

  \dataInfos{Input}{%itemize
    \item Sequence $\seq = (\seqelt{k})_k \subset \matSpace[\rdim][\cdim]$,
    \item bound $\degBd \in \NN$.
  }

  \dataInfo{Output}{
    a matrix 
  }
\end{problembox}

\bibliographystyle{plain}
\bibliography{biblio.bib}

\end{document}
