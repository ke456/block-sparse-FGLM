\documentclass[12pt]{article}
\usepackage{fullpage,url,amsmath,amsthm,amssymb,epsfig,color,xspace,mathrsfs}
\pagestyle{empty}

\usepackage{fullpage}

\thispagestyle{empty}

\begin{document}
\noindent\textbf{Lemma 1:} Let $U,V \in \mathbb{K}^{D\times M}$
be matrices with random entries and $s = (U^{tr}T_1^iV)_{i \ge 0}$. If 
$Z = \sum_{i = 0}^{\infty} s^{(i)}/ t^{i+1}$, then each entry of $Z$ is
in the form $n_*/P$, where $P$ is the minimum scalar generator for
$s$.\\

\noindent\textit{Proof:} Rewrite $U,V$ as 
$U = [u_1,u_2,\cdots,u_M], V= [v_1,v_2,\cdots,v_M]$, then 
$$s^{(i)} = 
\begin{bmatrix}
u_1^{tr}T_1^iv_1 & u_1^{tr}T_1^iv_2 & \cdots   & u_1^{tr}T_1^iv_M \\
u_2^{tr}T_1^iv_1 & \cdots           & \cdots   & u_2^{tr}T_1^iv_M \\
\vdots           & \ddots           & \ddots   & \vdots \\
u_M^{tr}T_1^iv_1 & \cdots           & \cdots   & u_M^{tr}T_1^iv_M
\end{bmatrix}$$

Thus, 	
$$ Z = 
\begin{bmatrix}
\sum u_1^{tr}T_1^iv_1/t^{i+1} & \cdots  & \cdots & \sum u_1^{tr}T_1^iv_M/t^{i+1} \\
\vdots                        & \ddots  & \ddots & \vdots \\
\sum u_M^{tr}T_1^iv_1/t^{i+1} & \cdots  & \cdots & \sum u_M^{tr}T_1^iv_M/t^{i+1}
\end{bmatrix}$$
So each entry separately is what would be computed in the scalar case. Therefore,
we can rewrite each entry as $n_*/P$ for some numerator $n_*$.\\

\noindent\textbf{Lemma 2:} Let $S$ be the minimum generating polynomial matrix for $s$
and $D = ASB$ be the Smith normal form of $S$. Furthermore, let $s_1, \cdots s_D$ be
invariant factors of $S$ such that $s_1 | s_2 | \cdots | s_D$. Then, there exists a vector $\tilde{u}$
such that $\tilde{u} S = [0, \cdots, 0, s_D]$\\

\noindent\textit{Proof:} Let $[b_1,\cdots,b_D]$ be the last row of $B$ and 
$w = [\frac{s_Db_1}{s1},\frac{s_Db_2}{s2},\cdots,\frac{s_Db_{D-1}}{s_{D-1}},b_D]$ (since $s_i | s_D$), then
\begin{align*}
	(w A) A^{-1} D &=  [\frac{s_Db_1}{s1},\frac{s_Db_2}{s2},\cdots,\frac{s_Db_{D-1}}{s_{D-1}},b_D]
	\begin{bmatrix}
	s_1 &        & \\
	    & \ddots & \\
	    &        & s_D
	\end{bmatrix}\\
	    &= [s_Db_1, s_Db_2, \cdots, s_Db_D]\\
	    &= [0,\cdots,0,s_D] B
\end{align*}
Therefore, if we choose $\tilde{u} = w A$, we get
$ \tilde{u} S = (w A) A^{-1} D B^{-1} = [0,\cdots,0,s_D]$ as needed.\\

\noindent\textbf{Lemma 3:} If $\sum_{i = 0}^{\infty} s^{(i)} t^i = S^{-1}N$, then $deg(N)$ is
less than or equal to $deg(S)$. TODO\\

\noindent\textbf{Theorem 1:} If 
$S^{-1}N = \sum_{i=0}^{\infty} s^{(i)}/t^{i+1}$, the first entry
of the last row of $\tilde{u} N$ is  the numerator of the generating function for 
$(u_{M}^{tr} T_1^i v_{1})_{i \ge 0}$.\\

\noindent\textit{Proof:} Let $S^{-1}N = \sum_{i=0}^{\infty} s^{(i)}/t^{i+1}$, 
then by lemma 1 
$$ N = S \sum_{i=0}^{\infty} s^{(i)}/t^{i+1} = S 
\begin{bmatrix}
n_{1,1} / P & \cdots & n_{1,M} / P \\
\vdots      & \ddots & \vdots \\
n_{M,1} / P & \cdots & n_{M,M} / P
\end{bmatrix}
$$
From theorem 1 of (randomXY-proof), we know that the $i^{th}$ invariant factor of
$XI - A$ is equal to the $i^{th}$ invariant factor of $S$ for generic choice of
$U,V$. Thus, $s_D = P$ and by lemma 2
\begin{align*}
\tilde{u} N &= \tilde{u} S
				\begin{bmatrix}
				n_{1,1} / P & \cdots & n_{1,M} / P \\
				\vdots            & \ddots & \vdots \\
				n_{M,1} / P & \cdots & n_{M,M} / P
				\end{bmatrix} \\
            &= [0,\cdots,0,P]
               \begin{bmatrix}
               n_{1,1} / P & \cdots & n_{1,M} / P \\
               \vdots            & \ddots & \vdots \\
               n_{M,1} / P & \cdots & n_{M,M} / P
               \end{bmatrix}\\
            &= [n_{M,1} , \cdots , n_{M,M}]
\end{align*}

\end{document}



